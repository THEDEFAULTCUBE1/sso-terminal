<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>S.S.O. Terminal — Mk.III (Classified)</title>
<style>
  :root{
    --bg:#000;
    --text:#8ef08e;
    --accent:#62d662;
    --muted:#2f6f2f;
    --warn:#ffd166;
    --err:#ff6b6b;
    --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "Courier New", monospace;
  }
  html,body{height:100%;margin:0;background:#000;}
  body{
    font-family:var(--mono);
    color:var(--text);
    display:flex;
    align-items:center;
    justify-content:center;
    padding:22px;
    background: radial-gradient(ellipse at top left, rgba(0,30,0,0.08) 0%, rgba(0,0,0,1) 65%);
  }
  .frame{
    width:960px;
    max-width:96vw;
    height:760px;
    background:linear-gradient(180deg, rgba(0,0,0,0.96), rgba(0,0,0,0.995));
    border-radius:8px;
    box-shadow:0 18px 80px rgba(0,0,0,0.95), inset 0 0 48px rgba(0,255,0,0.02);
    border:2px solid rgba(30,255,30,0.04);
    position:relative;
    overflow:hidden;
  }
  .status{position:absolute;left:0;right:0;top:0;padding:8px 14px;border-bottom:1px solid rgba(255,255,255,0.02);color:var(--muted);font-size:13px}
  .display{
    padding:38px 18px 18px 18px;
    height:100%;
    overflow:auto;
    box-sizing:border-box;
    position:relative;
  }
  .line{white-space:pre-wrap;line-height:1.35;font-size:15.4px;color:var(--text);margin:0 0 6px 0;}
  .muted{color:var(--muted)}
  .accent{color:var(--accent)}
  .err{color:var(--err)}
  .warn{color:var(--warn)}
  .box{border:1px dashed rgba(100,255,100,0.05);padding:10px;border-radius:4px;background:transparent}
  .cmdline{margin-top:8px}
  .prompt{display:inline-block}
  .input{outline:none;border:none;background:transparent;color:var(--text);font-family:var(--mono);font-size:15.4px}
  .cursor{display:inline-block;width:10px;height:20px;background:var(--text);margin-left:6px;vertical-align:bottom;animation:blink 1s steps(2,end) infinite}
  @keyframes blink{50%{opacity:0}}
  pre{font-family:var(--mono);font-size:15px;white-space:pre-wrap;word-break:break-word}
  /* Loading bars */
  .loading-wrp{display:block;width:74%;min-width:380px;margin-top:6px;margin-bottom:6px}
  .loading-label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
  .loading-track{width:100%;height:12px;background:rgba(0,255,0,0.03);border-radius:6px;border:1px solid rgba(0,255,0,0.02);overflow:hidden}
  .loading-bar{height:100%;width:0%;background:linear-gradient(90deg,var(--accent), #9ef09a);box-shadow:inset 0 -6px 12px rgba(0,0,0,0.2)}
  .loading-percent{display:inline-block;margin-left:8px;color:var(--muted);font-size:13px}
  /* scanlines + glow + distortion */
  .crt{
    position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;
    background-image: linear-gradient(rgba(0,0,0,0.0) 50%, rgba(0,0,0,0.025) 51%);
    background-size: 100% 4px;
    mix-blend-mode:overlay;
  }
  .glow{position:absolute;left:-10%;top:-10%;width:120%;height:120%;pointer-events:none;background:radial-gradient(circle at 20% 10%, rgba(0,255,50,0.03), transparent 15%);}
  .flicker{animation:flicker 0.14s infinite}
  @keyframes flicker{0%,100%{opacity:1}50%{opacity:0.22}}
  .jitter{transform:translateY(0)}
  /* ascii */
  .ascii{font-family:var(--mono);font-size:11px;letter-spacing:1px;color:var(--muted)}
  /* small helpers */
  .small{font-size:12px;color:rgba(142,240,142,0.6)}
  .hidden{display:none}
  /* scrollbar style */
  .display::-webkit-scrollbar{width:12px}
  .display::-webkit-scrollbar-thumb{background:rgba(0,255,0,0.06);border-radius:6px}
</style>
</head>
<body>
  <div class="frame" role="region" aria-label="S.S.O. Terminal">
    <div class="status small">S.S.O. SYSTEM — SECTOR 07 ACCESS PANEL</div>
    <div id="display" class="display" tabindex="0" aria-live="polite"></div>
    <div class="crt"></div>
    <div class="glow"></div>
  </div>

<script>
/* ====================== CONFIG ====================== */
/* PASSWORD: change to your preferred password */
const CORRECT_PASSWORD = 'REDACTED';

/* LOG#1 — mission brief (kept blank fields as requested) */
const LOG1 =
`[CLASSIFIED – LEVEL 5]

UNIT: S.S.O. — TASK FORCE
MISSION DATE: 01 March 2024
OPERATION: [REDACTED]

DEPLOYMENT: Rotary insertion to Sector 07

FORCE COMPOSITION: 9 personnel (including commanding officer)

PRIMARY OBJECTIVES:
1. Locate and secure designated anomalous objects.
2. Recover all available research/data relevant to the site.
3. Evacuate all mission-critical personnel and materiel.
4. Establish visual and electronic confirmation of interior conditions.

RULES OF ENGAGEMENT:
- Mission precedence: secure objects and data.
- Use of force authorized under direct threat to team or mission.
- Contact with objects: observe only unless otherwise ordered.

LOGISTICS:
- Insertion time: 0500 hours (local)
- Expected mission window: up to 36 hours (subject to command)
- Extraction: conditional; follow standing extraction protocol.

NOTES:
- Sector 07 classified as restricted; prior reconnaissance indicates anomalous activity.
- All footage and sensor data to be transmitted to Command for analysis.

AUTHORIZED:
Signature: ______________________
Name/Rank: [REDACTED]
Date: ______________________`;

/* LOG#2 — the exact lore timeline user provided (verbatim) */
const LOG2 =
`SSO has a small base located somewhere at the shores of greenland, and they sent a group to sector-07 to retrieve items of interests, but a huge group (basically this SSO) has been locked inside with no way out so they survive purely by what they can.

On the day of 08/03/2024 the SSO base lost all contact with the group

08/07/2024 Division gamma is founded for mysterious reasons prior to the G13-02 incident

17/09/2024 Division gamma plans a raid on a newfound underground bunker located somewhere near S-7

23/09/2024 Division gamma raids the bunker, after 3 days of no contact returning to the base without saying a word
Same day, SSO member sneaks up and listens in to the DivisionGamma agents conversation, hearing them mention dead bodies, keycards and they plan to return,
He is caught and executed by incineration.

25/09/2024 A group of SSO members follow the agents into the base, the group gets lost and one of them finds a keycard from the "GUARD Labs, security agent feniks", sso members yells out for his teammates to announce their sergeant was supposed to be apparently dead and knows about this place, Division gamma spots them, initiating a gun fight, division gamma returns missing one of the DG members.

30/09/2024, A group consisting of 75 SSO Low Ranks follow the DG agents into the base, finding out different variety of disturbing stuff, some sort of drug and experiments used on prisoners to transform them into superhumans.
DG finds out about the members and the 2 day war starts inside of the bunker, with firefights between highly trained agents and starters.

02/10/2024, All division gamma and SSO members are dead, with only 1 out of 15 DG agents surviving, returning to the base.

30/11/2024 SSO members discover all the experiments and the secret base, DG with no choice before anyone found out everything, nuked the research facility leaving everyone with no evidence`;

/* LOG#3 — short corrupted summary (still using only facts you've given) */
const LOG3 =
`[REDACTED FILE: SUMMARY]
- CONTACT LOST: 08/03/2024
- DIVISION GAMMA FORMATION: 08/07/2024
- BUNKER RAID/ENGAGEMENTS: SEP 2024
- MASS CASUALTIES & FACILITY NUKED: 30/11/2024
[END OF FILE]`;

/* ====================== END CONFIG ====================== */

/* ========= Terminal / Audio Engine ========= */
const display = document.getElementById('display');
let audioCtx = null;
function ensureAudio(){ if(!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)(); }
function beep(f=880, t=0.06, type='sine', vol=0.06){
  ensureAudio();
  const o = audioCtx.createOscillator();
  const g = audioCtx.createGain();
  o.type = type; o.frequency.value = f;
  g.gain.value = vol;
  o.connect(g); g.connect(audioCtx.destination);
  o.start();
  o.stop(audioCtx.currentTime + t);
}
function noiseBurst(duration=0.12, vol=0.04){
  ensureAudio();
  const sr = audioCtx.sampleRate;
  const buffer = audioCtx.createBuffer(1, sr * duration, sr);
  const data = buffer.getChannelData(0);
  for(let i=0;i<data.length;i++) data[i] = (Math.random()*2-1) * (1 - i/data.length);
  const src = audioCtx.createBufferSource();
  src.buffer = buffer;
  const g = audioCtx.createGain(); g.gain.value = vol;
  src.connect(g); g.connect(audioCtx.destination);
  src.start();
}

/* ================= Terminal helpers ================ */
function write(text, cls){
  const d = document.createElement('div');
  d.className = 'line' + (cls ? ' ' + cls : '');
  d.textContent = text;
  display.appendChild(d);
  display.scrollTop = display.scrollHeight;
  return d;
}
function writeHTML(node){
  display.appendChild(node);
  display.scrollTop = display.scrollHeight;
  return node;
}
function delay(ms){ return new Promise(r => setTimeout(r, ms)); }

async function typeLine(text, speed=6, cls){
  const container = document.createElement('div');
  container.className = 'line' + (cls ? ' ' + cls : '');
  const span = document.createElement('span');
  container.appendChild(span);
  writeHTML(container);
  for(let i=0;i<text.length;i++){
    span.textContent += text[i];
    if(Math.random() < 0.03) { if(Math.random() < 0.4) beep(600 + Math.random()*400, 0.02, 'square', 0.02); }
    display.scrollTop = display.scrollHeight;
    await delay(speed + Math.random()*speed);
  }
  return container;
}

/* ---------- loading block (visible, with sound) ---------- */
async function loadingBlock(label, dur=1200){
  const wrap = document.createElement('div'); wrap.className = 'loading-wrp';
  const lbl = document.createElement('div'); lbl.className = 'loading-label muted'; lbl.textContent = label;
  const track = document.createElement('div'); track.className = 'loading-track';
  const bar = document.createElement('div'); bar.className = 'loading-bar';
  const pct = document.createElement('span'); pct.className = 'loading-percent muted'; pct.textContent = '0%';
  track.appendChild(bar); wrap.appendChild(lbl); wrap.appendChild(track); wrap.appendChild(pct);
  writeHTML(wrap);
  const steps = Math.max(20, Math.floor(dur / 40));
  for(let i=1;i<=steps;i++){
    const p = Math.floor((i/steps) * 100);
    bar.style.width = p + '%'; pct.textContent = p + '%';
    if(Math.random() < 0.5) beep(440 + p*2, 0.02, 'sine', 0.01 + p/2000);
    await delay(Math.floor(dur/steps) + Math.random()*20);
    // occasional tiny glitch visually
    if(Math.random() < 0.03){
      bar.style.width = Math.min(100, (p + Math.floor(Math.random()*6))) + '%';
    }
  }
  bar.style.width = '100%'; pct.textContent = '100%';
  beep(980, 0.07, 'sine', 0.06);
  const done = document.createElement('div'); done.className = 'line success'; done.textContent = '] DONE';
  writeHTML(done);
  await delay(120);
}

/* ---------- flicker + jitter loop ---------- */
let flickerActive = true;
async function flickerLoop(){
  const frame = document.querySelector('.frame');
  while(flickerActive){
    frame.classList.add('flicker');
    if(Math.random() < 0.25) noiseBurst(0.045, 0.025);
    await delay(90 + Math.random()*130);
    frame.classList.remove('flicker');
    // every so often a small text jitter
    if(Math.random() < 0.18){
      const displayEl = document.querySelector('.display');
      displayEl.style.transform = `translate(${(Math.random()-0.5)*1.6}px, ${(Math.random()-0.5)*1.6}px)`;
      await delay(60 + Math.random()*80);
      displayEl.style.transform = '';
    }
    await delay(1800 + Math.random()*2200);
  }
}

/* ========= Corruption system =========
   - every command increments corruption
   - intensity alters glitch frequency and visual corruption
*/
let corruption = 0;
function increaseCorruption(amount=1){
  corruption += amount;
  if(corruption >= 12) triggerCriticalFailure();
  // small visual hint
  if(Math.random() < corruption/40) makeShortGlitch();
}
function makeShortGlitch(){
  // transient random red errors
  const count = 1 + Math.floor(Math.random()*3);
  for(let i=0;i<count;i++){
    write('<<< ERROR ' + Math.floor(Math.random()*9999) + ' ::: DATA CORRUPTION >>>', 'err');
  }
  noiseBurst(0.06, 0.03);
}

/* ---------- boot sequence ---------- */
let receivedPrinted = false;
async function boot(){
  flickerLoop();
  await typeLine('BOOT: S.S.O. SECURE ACCESS PANEL INITIALIZING...\n', 9);
  await loadingBlock('Loading secure transit modules (sector 07)', 1400);
  await loadingBlock('Verifying integrity of sector data', 1100);
  await loadingBlock('Decrypting mission parameters', 1000);
  await loadingBlock('Initializing security protocols', 1000);
  await loadingBlock('Calibrating terminal sensors', 1000);
  await typeLine('AUTH MODULE: ONLINE\n', 10);
  await delay(200);
  await typeLine('ENTER PASSWORD TO PROCEED:\n\n', 12);
  await showPasswordPrompt();
}

/* ---------- password prompt ---------- */
async function showPasswordPrompt(){
  const line = document.createElement('div'); line.className = 'line';
  const prompt = document.createElement('span'); prompt.className = 'prompt'; prompt.textContent = 'PASSWORD> ';
  const input = document.createElement('input'); input.className = 'input'; input.type = 'password'; input.autocomplete='off'; input.spellcheck=false;
  input.style.width = '44%';
  const cursor = document.createElement('span'); cursor.className = 'cursor';
  line.appendChild(prompt); line.appendChild(input); line.appendChild(cursor);
  writeHTML(line);
  focusLastInput();
  input.addEventListener('keydown', async (e) => {
    if(e.key === 'Enter'){
      input.disabled = true; cursor.remove();
      if(!receivedPrinted){
        write('RECEIVED', 'muted'); receivedPrinted = true;
      }
      beep(720, 0.06, 'square', 0.06);
      await delay(140);
      const val = input.value || '';
      if(val === CORRECT_PASSWORD){
        write('\nACCESS GRANTED\n', 'accent');
        beep(1200, 0.12, 'sine', 0.08);
        increaseCorruption(0); // success doesn't increase
        await delay(300);
        startShell();
      } else {
        write('\nACCESS DENIED\n', 'err');
        noiseBurst(0.12, 0.05);
        increaseCorruption(1);
        await delay(260);
        showPasswordPrompt();
      }
    } else {
      // optional tiny key sound sometimes
      if(Math.random() < 0.18) beep(600 + Math.random()*160, 0.02, 'square', 0.01);
    }
  });
}

/* ---------- shell / commands ---------- */
function startShell(){
  write('Welcome to S.S.O. LOCAL SHELL. Type HELP for commands.\n', 'accent');
  showCommandPrompt();
}

function showCommandPrompt(){
  const line = document.createElement('div'); line.className = 'line cmdline';
  const prompt = document.createElement('span'); prompt.className = 'prompt'; prompt.textContent = 'S.S.O.# ';
  const input = document.createElement('input'); input.className = 'input'; input.type = 'text'; input.autocomplete='off'; input.spellcheck=false;
  input.style.width = '72%';
  const cursor = document.createElement('span'); cursor.className = 'cursor';
  line.appendChild(prompt); line.appendChild(input); line.appendChild(cursor);
  writeHTML(line);
  focusLastInput();
  input.addEventListener('keydown', async (e) => {
    if(e.key === 'Enter'){
      input.disabled = true; cursor.remove();
      const raw = input.value.trim();
      const cmd = raw.toUpperCase();
      // light typing beep
      if(Math.random() < 0.6) beep(540, 0.04, 'sine', 0.02);
      await handleCommand(cmd, raw);
    } else {
      if(Math.random() < 0.12) beep(660, 0.02, 'square', 0.01);
    }
  });
}

async function handleCommand(cmd, raw){
  increaseCorruption(0.5); // each command slightly increases corruption
  if(!cmd) { showCommandPrompt(); return; }
  if(cmd === 'HELP'){
    write('\nAVAILABLE COMMANDS:', 'muted');
    write('  LOG#1        - OPEN OPERATION LOG 1 (MISSION BRIEF)');
    write('  LOG#2        - OPERATIONAL TIMELINE (RECOVERED)'); 
    write('  LOG#3        - FILE SUMMARY (REDACTED)');
    write('  DIR          - LIST FILESYSTEM');
    write('  READ <file>  - READ FILE (MANY FILES ENCRYPTED)');
    write('  TRACE        - RUN RADAR TRACE (ASCII)');
    write('  PING <host>  - TEST NETWORK LATENCY');
    write('  CONNECT      - ATTEMPT NETWORK HANDSHAKE');
    write('  DECRYPT      - RUN DECRYPTION ROUTINE (SIMULATED)');
    write('  LOCATE       - RUN COORDINATE SCAN');
    write('  OVERRIDE     - FORCE ACCESS (RISKY)');
    write('  REBOOT       - REBOOT TERMINAL');
    write('  ASCII        - SHOW ASCII STATIC');
    write('  CLEAR        - CLEAR SCREEN');
    write('  EXIT         - LOGOUT SESSION\n');
    showCommandPrompt();
  }
  else if(cmd === 'CLEAR'){
    display.innerHTML = '';
    const st = document.createElement('div'); st.className='status small'; st.textContent = 'S.S.O. SYSTEM — SECTOR 07 ACCESS PANEL';
    display.parentNode.insertBefore(st, display);
    write('\n> SCREEN CLEARED\n', 'muted');
    increaseCorruption(0.2);
    showCommandPrompt();
  }
  else if(cmd === 'EXIT'){
    write('\n> SESSION TERMINATED.\n', 'muted');
    beep(320, 0.06, 'sine', 0.04);
    await delay(200);
    location.reload();
  }
  else if(cmd === 'LOG#1'){
    write('\n'); const pre = document.createElement('pre'); pre.className='box'; pre.textContent = LOG1; writeHTML(pre);
    increaseCorruption(0.6);
    showCommandPrompt();
  }
  else if(cmd === 'LOG#2'){
    write('\n'); const pre2 = document.createElement('pre'); pre2.className='box'; pre2.textContent = LOG2; writeHTML(pre2);
    increaseCorruption(1.0);
    showCommandPrompt();
  }
  else if(cmd === 'LOG#3'){
    write('\n'); const pre3 = document.createElement('pre'); pre3.className='box'; pre3.textContent = LOG3; writeHTML(pre3);
    increaseCorruption(1.2);
    showCommandPrompt();
  }
  else if(cmd === 'DIR'){
    write('\nSYSTEM FILES:\n - LOG#1.TXT\n - LOG#2.TXT\n - SUMMARY.LOG\n - SECTOR07.DAT\n - SECURE.DRIVE\n - ARCHIVE/ (ENCRYPTED)\n', 'muted');
    increaseCorruption(0.4);
    showCommandPrompt();
  }
  else if(cmd.startsWith('READ')){
    write('\nACCESS DENIED: FILE ENCRYPTED', 'err');
    noiseBurst(0.12, 0.05);
    increaseCorruption(1.1);
    // small chance partial read (glitched) if enough corruption
    if(corruption > 6 && Math.random() < 0.18){
      await delay(220);
      write('\n-- PARTIAL READ --', 'warn');
      write('...XCONTENTS-REDACTED...'); // no new lore
      increaseCorruption(0.8);
    }
    showCommandPrompt();
  }
  else if(cmd === 'TRACE'){
    await runAsciiRadar();
    increaseCorruption(1.4);
    showCommandPrompt();
  }
  else if(cmd.startsWith('PING')){
    const host = cmd.split(' ')[1] || 'hq';
    await doPing(host);
    increaseCorruption(0.6);
    showCommandPrompt();
  }
  else if(cmd === 'CONNECT'){
    await doConnect();
    increaseCorruption(1.5);
    showCommandPrompt();
  }
  else if(cmd === 'DECRYPT'){
    await doDecrypt();
    increaseCorruption(1.6);
    showCommandPrompt();
  }
  else if(cmd === 'LOCATE'){
    await doLocate();
    increaseCorruption(0.9);
    showCommandPrompt();
  }
  else if(cmd === 'OVERRIDE'){
    write('\nATTEMPTING OVERRIDE... (HIGH RISK)', 'warn');
    beep(420, 0.06, 'sawtooth', 0.04);
    await delay(700);
    // glitch chance
    if(Math.random() < 0.6 || corruption > 6){
      write('\nOVERRIDE FAILED: SECURITY COUNTERMEASURES ENGAGED', 'err');
      for(let i=0;i<3;i++){ write('<<< INTRUSION ALERT >>>', 'err'); await delay(90); }
      increaseCorruption(2);
    } else {
      write('\nOVERRIDE SUCCESS (TEMPORARY ACCESS)', 'accent');
      // reveal nothing sensitive
    }
    showCommandPrompt();
  }
  else if(cmd === 'REBOOT'){
    await doReboot();
    // reboot resets some corruption but keep a baseline
  }
  else if(cmd === 'ASCII'){
    await showAsciiStatic();
    increaseCorruption(0.5);
    showCommandPrompt();
  }
  else {
    write('\nSYSTEM ERROR: UNKNOWN COMMAND ' + cmd, 'err');
    noiseBurst(0.08, 0.035);
    increaseCorruption(1.0);
    // sometimes the terminal echoes back a corrupted echo of command
    if(Math.random() < Math.min(0.5, corruption/8)){
      await delay(120);
      write('ECHO: ' + corruptText(cmd), 'muted');
    }
    showCommandPrompt();
  }
}

/* ---------- special routines ---------- */

async function runAsciiRadar(){
  write('\nRADAR TRACE: INITIALIZING\n', 'muted');
  const rows = 12;
  for(let r=0;r<rows;r++){
    let line = '';
    for(let c=0;c<72;c++){
      if(Math.random() < Math.max(0.02, 0.01 + r*0.002)) line += (Math.random() < 0.02 ? '*' : '.');
      else line += ' ';
    }
    write(line, 'ascii');
    if(r % 3 === 0) beep(420 + r*20, 0.02, 'sine', 0.02);
    await delay(60);
  }
  write('\nTRACE COMPLETE: NO CONSPICUOUS SIGNATURES', 'muted');
  beep(820, 0.06, 'sine', 0.04);
}

async function doPing(host){
  write(`\nPING ${host} ...`, 'muted');
  const attempts = 4;
  for(let i=0;i<attempts;i++){
    await delay(220 + Math.random()*160);
    const time = Math.floor(20 + Math.random()*200 + (corruption * 8));
    write(`Reply from ${host}: time=${time}ms`, 'muted');
    beep(560, 0.02, 'sine', 0.01);
  }
  if(Math.random() < 0.18){
    write('Request timed out.', 'err');
    noiseBurst(0.06, 0.03);
  } else write('Ping complete.', 'muted');
}

async function doConnect(){
  write('\nNETWORK HANDSHAKE: START', 'muted');
  await delay(180);
  // handshake sequence
  await loadingBlock('Establishing secure channel', 900);
  // success chance impacted by corruption
  if(Math.random() < Math.max(0.2, 0.9 - corruption/10)){
    write('\nHANDSHAKE: ESTABLISHED', 'accent');
    beep(1200, 0.08, 'sine', 0.06);
  } else {
    write('\nHANDSHAKE: FAILED (TIMEOUT)', 'err');
    noiseBurst(0.12, 0.05);
    increaseCorruption(1.0);
  }
}

async function doDecrypt(){
  write('\nDECRYPTION: INITIATING', 'muted');
  // visual decrypt: many lines scrolling
  for(let i=0;i<18;i++){
    const s = generateHexLine(64);
    write(s, 'small');
    if(i % 4 === 0) beep(720 + i*6, 0.02, 'square', 0.02);
    await delay(50);
  }
  // end result: show that it was redacted (no new lore added)
  write('\nDECRYPTION COMPLETE: CONTENT REDACTED OR CORRUPTED', 'warn');
  increaseCorruption(1.5);
}

async function doLocate(){
  write('\nCOORDINATE SCAN: SEARCHING FOR SECTOR 07 SIGNATURES', 'muted');
  await loadingBlock('Scanning regional beacons', 900);
  write('\nSCAN RESULT: SIGNALS FOUND (STABLE)', 'muted');
  beep(860, 0.05, 'sine', 0.04);
  // no coordinates revealed (keep canon)
}

function generateHexLine(len){
  const hex = '0123456789ABCDEF';
  let s = '';
  for(let i=0;i<len;i++){
    s += hex[Math.floor(Math.random()*hex.length)];
  }
  return s;
}

/* ---------- ascii static ---------- */
async function showAsciiStatic(){
  for(let r=0;r<18;r++){
    let line = '';
    for(let c=0;c<96;c++){
      if(Math.random() < 0.035) line += String.fromCharCode(33 + Math.floor(Math.random()*94));
      else line += ' ';
    }
    write(line, 'ascii muted');
    if(r % 4 === 0) noiseBurst(0.03, 0.01);
    await delay(24);
  }
}

/* ---------- Reboot / failure ---------- */
async function doReboot(){
  write('\nREBOOTING SYSTEM...', 'muted');
  beep(330, 0.06, 'sine', 0.05);
  await delay(420);
  // reset some things
  corruption = Math.max(0, corruption - 6);
  receivedPrinted = false;
  display.innerHTML = '';
  const st = document.createElement('div'); st.className='status small'; st.textContent = 'S.S.O. SYSTEM — SECTOR 07 ACCESS PANEL';
  display.parentNode.insertBefore(st, display);
  await delay(140);
  await boot(); // restart boot sequence
}

async function triggerCriticalFailure(){
  // escalate visual + audio to simulate terminal meltdown, then reboot to partial state
  flickerActive = false;
  write('\n!!! CRITICAL SYSTEM FAILURE !!!', 'err');
  for(let i=0;i<8;i++){
    write('<<< CORE MEMORY DUMPING ::: SECTOR STREAM CORRUPTION >>>', 'err');
    noiseBurst(0.12 + Math.random()*0.1, 0.06);
    await delay(120 + Math.random()*150);
  }
  // big corrupted visual
  for(let i=0;i<6;i++){
    write(corruptText('>>> CORRUPTION SEVERITY ' + Math.floor(Math.random()*999) + ' <<<'), 'err');
    await delay(140);
  }
  // force partial reboot
  write('\nFORCING EMERGENCY RESTART...', 'warn');
  await delay(750);
  // reduce corruption but leave some
  corruption = 3;
  // re-enable flicker loop
  flickerActive = true; flickerLoop();
  await doReboot();
}

/* ---------- utilities ---------- */
function corruptText(s){
  // randomly replace characters with odd glyphs to simulate corruption
  const glyphs = ['@','%','¥','ƒ','∑','■','▒','▓','█','Δ','Ж','?','*'];
  return s.split('').map(ch => (Math.random() < Math.min(0.3, corruption/10) ? glyphs[Math.floor(Math.random()*glyphs.length)] : ch)).join('');
}

function focusLastInput(){
  setTimeout(()=> {
    const inputs = display.querySelectorAll('input');
    if(inputs.length) inputs[inputs.length-1].focus();
    display.scrollTop = display.scrollHeight;
  }, 8);
}

/* ---------- minor short glitch visual ---------- */
function smallVisualGlitch(){
  const el = document.createElement('div');
  el.className = 'line err';
  el.textContent = '<< SIGNAL NOISE >>';
  display.appendChild(el);
  setTimeout(()=>{ el.remove(); }, 1200);
}

/* ---------- init ---------- */
(async function init(){
  // allow audio resume on first click
  document.addEventListener('click', function resume(){
    if(audioCtx && audioCtx.state === 'suspended') audioCtx.resume();
    document.removeEventListener('click', resume);
  });
  // initial boot
  await boot();
})();

/* accessibility: click to focus */
display.addEventListener('click', ()=> {
  const inputs = display.querySelectorAll('input');
  if(inputs.length) inputs[inputs.length-1].focus();
});

</script>
</body>
</html>